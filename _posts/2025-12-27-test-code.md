---
layout: post
title: Test Code Post
---

I am wanting to test code blocks in MD.

Here is a sample PowerShell code:

```PowerShell
#Create menu and select Azure environment
$ObjAzCom = New-Object -TypeName psobject
Add-Member -InputObject $ObjAzCom -MemberType NoteProperty -Name Name -Value "AzureCloud"
Add-Member -InputObject $ObjAzCom -MemberType NoteProperty -Name Desc -Value "Azure Commercial"
$ObjAzGov = New-Object -TypeName psobject
Add-Member -InputObject $ObjAzGov -MemberType NoteProperty -Name Name -Value "AzureUSGovernment"
Add-Member -InputObject $ObjAzGov -MemberType NoteProperty -Name Desc -Value "Azure Government"
$ObjAzEnvGroup = @($ObjAzCom,$ObjAzGov)
$AzureEnv = ($ObjAzEnvGroup | Out-GridView -Title "Select Azure Environment" -PassThru).Name
If ($null -eq $AzureEnv)
{
    Write-Host "No environment selected."
    Exit
}

#Login to Azure
$Time = Get-Date -Format g
Write-Host "$Time - Logging into Azure..."

If (([string]::IsNullOrEmpty($AzureUser)) -or ([string]::IsNullOrEmpty($AzurePassFile)))
{
    Connect-AzAccount -Environment $AzureEnv -WarningAction SilentlyContinue | Out-Null 
}
Else
{
    Connect-AzAccount -Credential $AzureCred -Environment $AzureEnv -SkipContextPopulation -WarningAction SilentlyContinue | Out-Null
}

If ($null -eq (Get-AzContext).Subscription)
{
    Write-Host "No subscriptions for login."
    Exit
}

$Time = Get-Date -Format g
Write-Host "$Time - Logged in..."

#Get Azure subscriptions and select one
$AzAccountVer = (Get-Module -Name Az.Accounts).Version
If ([int]$AzAccountVer.Major -lt 3)
{
    Try
    {
        $Time = Get-Date -Format g
        Write-Host "$Time - Getting Azure Subscriptions..."
        $Subscription = Get-AzSubscription -WarningAction SilentlyContinue | Select-Object Id | Out-GridView -Title "Select Azure Subscription" -PassThru
        Select-AzSubscription -SubscriptionId $Subscription.Id -WarningAction SilentlyContinue | Out-Null
        $Time = Get-Date -Format g
        Write-Host "$Time - Selected Azure Subscription: $($Subscription.Name)"
    }
    Catch
    {
        $Time = Get-Date -Format g
        Write-Host "$Time - Failed to get/select Azure subscription.  The error was $($_.Exception.Message).  The error was at Line: $($_.InvocationInfo.Line)  Position: $($_.InvocationInfo.PositionMessage)"
        Exit
    }
}
```
